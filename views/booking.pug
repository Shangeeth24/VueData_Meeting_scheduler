doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title Booking
    link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css")
    //- link(rel="stylesheet", href="./styles.css")

  body(class="bg-dark d-flex align-items-center justify-content-center", style="min-height: 100vh; margin: 0;")
    div(class="bg-white rounded p-4 shadow", style="flex-wrap: wrap; display: flex;")
      div.col.p-3(id="card-id")
        h1 MEETING BOOKING
        form(id="bookingForm")
          div.mb-3
            //- label.form-label(for="meetingId") Meeting ID
            //- input#meetingId.form-control(type="number", name="meetingId")
          div.mb-3
            label.form-label(for="roomId") Room
            select#roomId.form-select(name="roomId")
              

          div.mb-3
            label.form-label(for="starttime") Start Time
            input#starttime.form-control(type="datetime-local", name="starttime")

          div.mb-3
            label.form-label(for="endtime") End Time
            input#endtime.form-control(type="datetime-local", name="endtime")

          div.mb-3
            label.form-label(for="employeeId") Organizer Name
            select#employeeId.form-select(name="employeeId")




          
          div.row.gx-2.gy-3
            div.col
              button.btn.btn-primary.w-100(type="button", onclick="insertFunction()") Insert
            div.col
              button.btn.btn-primary.w-100(type="button", onclick="updateFunction()") Update

          div.row.gx-2.gy-3.mt-3
            div.col
              button.btn.btn-primary.w-100(type="button", onclick="deleteFunction()") Delete
            div.col
              button.btn.btn-primary.w-100(type="button", onclick="clearFunction()") Clear

    script.

      function clearFunction() {
        //- document.getElementById('meetingId').value = '';
        document.getElementById('roomId').value = 'War Room'; 
        document.getElementById('starttime').value = '';
        document.getElementById('endtime').value = '';
        document.getElementById('employeeId').value = '';

      }

      async function fetchRooms() {
        const response = await fetch('http://127.0.0.1:3112/getRooms');
    
        const rooms = await response.json();
        const selectElement = document.getElementById('roomId');
        while (selectElement.firstChild) {
          selectElement.removeChild(selectElement.firstChild);
        }

        rooms.forEach((room) => {
          const optionElement = document.createElement('option');
          optionElement.value = room.roomId;
          optionElement.textContent = room.room;
          selectElement.appendChild(optionElement);
        })
      }

      async function fetchEmployees() {
        const response = await fetch('http://127.0.0.1:3112/getEmployees');
        const employees = await response.json();
        const selectElement = document.getElementById('employeeId');
        while (selectElement.firstChild) {
          selectElement.removeChild(selectElement.firstChild);
        }
        employees.forEach((employee) => {
          const optionElement = document.createElement('option');
          optionElement.value = employee.employeeId;
          optionElement.textContent = employee.employeeId;
          selectElement.appendChild(optionElement);
          })
      }
        

      window.onload = function(){
        fetchRooms();
        fetchEmployees();
      };

        



      
      function insertFunction() {
        //- const meetingId = document.getElementById('meetingId').value;
        const roomId = document.getElementById('roomId').value;
        const startTime = document.getElementById('starttime').value;
        const endTime = document.getElementById('endtime').value;
        const employeeId = document.getElementById('employeeId').value;

        const formData = {
          //- meetingId,
          roomId,
          startTime,
          endTime,
          employeeId
        };

        fetch("/insertBooking", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(formData),
        })
        .then(response => response.json())
        .then(data => console.log(data))
        clearFunction()
        
        .catch((error) => console.error('Error:', error));
      }


   